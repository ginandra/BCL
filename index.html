<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BCL Kiosk</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
  <script src="https://unpkg.com/feather-icons"></script>
  <style>
    body, html {
      height: 100%;
      background: linear-gradient(to right, #00c6ff, #0072ff);
      font-family: 'Segoe UI', sans-serif;
    }
    .swiper-pagination-bullet {
      background: white !important;
      opacity: 0.5;
    }
    .swiper-pagination-bullet-active {
      opacity: 1;
    }
	  
  .menu-btn i {
    width: 24px;
    height: 24px;
    margin-bottom: 0.5rem;
  }
  </style>
</head>
<body>
  <div class="swiper h-screen w-full">
    <div class="swiper-wrapper">

      <!-- Slide 1 -->
      <div class="swiper-slide">
        <div class="flex justify-center items-center min-h-screen w-full">
          <div class="text-white text-center px-4">
            <img src="bifalogo.png" alt="Logo BIFA" class="w-100 h-auto mb-6 mx-auto" />
            <h1 class="text-4xl md:text-5xl font-extrabold mb-4 drop-shadow">
              Student Information Access - <span class="text-white font-bold">BCL</span>
            </h1>
            <p class="text-lg md:text-xl max-w-xl mx-auto drop-shadow mb-4">
              Quick access to your schedules, grades, and learning resources. <br />
              Stay informed through BIFA Cloud Library.
            </p>
<!-- 			<a href="https://drive.google.com/drive/folder-link" target="_blank" class="inline-block bg-white text-blue-600 font-semibold px-6 py-3 rounded-full shadow-lg hover:bg-blue-100 transition duration-300">
        BCL Access
      </a> -->
          </div>
        </div>
      </div>

      <!-- Slide 2 -->
      <div class="swiper-slide">
        <div class="flex justify-center items-center min-h-screen w-full">
          <div class="text-white text-center px-4">
            <h1 class="text-3xl md:text-4xl font-bold mb-4 drop-shadow">üìÖ Flight Schedule Access</h1>
            <p class="text-lg md:text-xl max-w-xl mx-auto drop-shadow">
              Stay up to date with your flight and ground school schedule anytime.
            </p>
          </div>
        </div>
      </div>

      <!-- Slide 3 -->
      <div class="swiper-slide">
        <div class="flex justify-center items-center min-h-screen w-full">
          <div class="text-white text-center px-4">
            <h1 class="text-3xl md:text-4xl font-bold mb-4 drop-shadow">üìò Learning Materials</h1>
            <p class="text-lg md:text-xl max-w-xl mx-auto drop-shadow">
              Access study guides, SOPs, and documents directly from the cloud.
            </p>
          </div>
        </div>
      </div>

<!-- Slide 4 -->
<div class="swiper-slide">
  <div class="flex justify-center items-center min-h-screen w-full">
    <div class="flex flex-rows items-center gap-8 px-4 max-w-6xl mx-auto">

      <!-- Gambar pesawat besar di tengah -->
      <img src="Cessna.png" alt="Pesawat Cessna" class="w-full max-w-md h-auto mb-4" />

      <!-- Tombol menu di bawah gambar -->
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 gap-4 text-center w-full">
        <button onclick="openModal('Student Schedule', 'Check your daily ground and flight schedule.')" class="bg-white text-blue-600 font-semibold py-4 px-2 rounded-xl shadow-md hover:bg-blue-100 transition flex flex-col items-center justify-center text-sm"><i data-feather="calendar" class="w-6 h-6 mb-2"></i>Student Schedule</button>
        <button onclick="openModal('Flight Briefing', 'Access your flight briefing materials.')" class="bg-white text-blue-600 font-semibold py-4 px-2 rounded-xl shadow-md hover:bg-blue-100 transition flex flex-col items-center justify-center text-sm"><i data-feather="file-text" class="w-6 h-6 mb-2"></i>Flight Briefing</button>
        <button onclick="openModal('Grades Access', 'View your academic performance and progress.')" class="bg-white text-blue-600 font-semibold py-4 px-2 rounded-xl shadow-md hover:bg-blue-100 transition flex flex-col items-center justify-center text-sm"><i data-feather="bar-chart-2" class="w-6 h-6 mb-2"></i>Grades Access</button>
        <button onclick="openModal('Study Materials', 'Download SOPs and study guides.')" class="bg-white text-blue-600 font-semibold py-4 px-2 rounded-xl shadow-md hover:bg-blue-100 transition flex flex-col items-center justify-center text-sm"><i data-feather="book-open" class="w-6 h-6 mb-2"></i>Study Materials</button>
        <button onclick="openModal('Instructor Notes', 'Review notes from instructors.')" class="bg-white text-blue-600 font-semibold py-4 px-2 rounded-xl shadow-md hover:bg-blue-100 transition flex flex-col items-center justify-center text-sm"><i data-feather="clipboard" class="w-6 h-6 mb-2"></i>Instructor Notes</button>
        <button onclick="openModal('Request Form', 'Submit a request to the academy.')" class="bg-white text-blue-600 font-semibold py-4 px-2 rounded-xl shadow-md hover:bg-blue-100 transition flex flex-col items-center justify-center text-sm"><i data-feather="file-plus" class="w-6 h-6 mb-2"></i>Request Form</button>
      </div>

    </div>
  </div>
</div>

      <!-- Slide 1 -->
      <div class="swiper-slide">
        <div class="flex justify-center items-center min-h-screen w-full">
        <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‚úàÔ∏è BIFA - Daily Flight Schedule</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Bootstrap & Google Fonts -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />

  <!-- Swiper CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>

  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(to right, #e0f0ff, #f4f9ff);
      margin: 0;
      padding: 0;
      color: #333;
    }

    .card-flight {
      border-left: 5px solid #007bff;
      border-radius: 12px;
      padding: 1rem;
      background-color: #fff;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s;
      height: 100%;
    }

    .card-flight:hover {
      transform: translateY(-4px);
    }

    .card-header-flight {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .badge-time {
      font-size: 0.85rem;
      background: #dceeff;
      color: #007bff;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
    }

    .flight-detail-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.5rem;
      font-size: 0.85rem;
    }

    .summary-box {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1rem;
      margin-top: 2rem;
      padding: 1rem;
    }

    .summary-card {
      background: #f0f8ff;
      border-left: 5px solid #0d6efd;
      border-radius: 10px;
      padding: 1rem;
      text-align: center;
      font-weight: 600;
      color: #333;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }

    .summary-card p {
      margin: 0;
      font-size: 1rem;
      color: #007bff;
    }

    .summary-card span {
      display: block;
      font-size: 1.4rem;
      font-weight: bold;
      margin-top: 0.5rem;
    }

    .swiper {
      padding-bottom: 40px;
    }

    .swiper-pagination {
      bottom: 10px !important;
    }

    footer {
      text-align: center;
      font-size: 12px;
      margin-top: 40px;
      color: #999;
    }

  .fab-container {
      position: fixed;
      bottom: 20px;
      right: 20px;
    }

    .fab-main {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: #007bff;
      color: white;
      font-size: 30px;
      border: none;
      z-index: 2;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      position: relative;
      transition: transform 0.3s ease;
    }

    .fab-option {
      position: absolute;
      bottom: 0;
      right: 0;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: white;
      color: #007bff;
      border: 2px solid #007bff;
      font-size: 12px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transform: translate(0, 0);
      transition: transform 0.4s ease, opacity 0.3s ease;
      pointer-events: none;

      --angle: 0deg;
      --distance: 100px;
    }

    .fab-container.show .fab-option {
      pointer-events: auto;
      opacity: 1;
      transform: translate(
        calc(-1 * var(--distance) * cos(var(--angle))),
        calc(-1 * var(--distance) * sin(var(--angle)))
      );
    }

  </style>
</head>
<body>
  <!-- Floating Action Button with Radial Menu -->
  <div class="fab-container">
    <button id="fabToggle" class="fab-main"><i class="fas fa-plus"></i></button>

    <button class="fab-option" data-type="flight" style="--angle: 1deg;">Flight</button>
<button class="fab-option" data-type="ground" style="--angle: 90deg; --distance: 130px;">Ground</button>
<button class="fab-option" data-type="ftd" style="--angle: 55deg;">FTD</button>
  </div>

  <div class="container-fluid py-4">
    <h2 class="mb-4 text-primary fw-bold text-center">‚úàÔ∏è Daily Flight Schedule</h2>
    <div class="d-flex justify-content-between align-items-center mb-2">
  <div id="today" class="text-secondary fw-semibold fs-5"></div>
</div>

    <!-- Swiper Container -->
    <div class="swiper mySwiper">
      <div class="swiper-wrapper" id="flightsContainer">
        <!-- Flight cards injected here -->
      </div>
      <div class="swiper-pagination"></div>
    </div>

    <!-- Summary Section -->
    <div class="summary-box">
      <div class="summary-card">
        <p>üë®‚Äç‚úàÔ∏è Duty Instructor</p>
        <span id="instructor">-</span>
      </div>
      <div class="summary-card">
        <p>üìã Total Flight</p>
        <span id="total_flight">0</span>
      </div>
      <div class="summary-card">
        <p>üõ©Ô∏è Aircraft in Use</p>
        <span id="total_aircraft">0</span>
      </div>
      <div class="summary-card">
        <p>üïì Plan Duration</p>
        <span id="total_plan">00:00</span>
      </div>
    </div>
  </div>

  <footer>
    &copy; 2025 Ketut Cana | KIOSK Display System
  </footer>

  <!-- JS Resources -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

  <script>
const fabToggle = document.getElementById('fabToggle');
  const fabContainer = document.querySelector('.fab-container');
  fabToggle.addEventListener('click', toggleFAB);

 function toggleFAB() {
  const fabContainer = document.querySelector('.fab-container');
  fabContainer.classList.toggle('show');
  
}

  document.querySelectorAll('.fab-option').forEach(btn => {
    btn.addEventListener('click', (e) => {
      const type = e.target.getAttribute('data-type');

      const modalBody = document.getElementById('aircraftDetailContent');
      let title = '';
      let content = '';

      switch(type) {
        case 'flight':
          title = 'Flight Options';
          content = `<ul>
            <li>üìÖ Flight Schedule</li>
            <li>üìù Flight Report</li>
          </ul>`;
          break;
        case 'ground':
          title = 'Ground Options';
          content = `<ul>
            <li>üìÖ Ground Schedule</li>
            <li>üìù Ground Report</li>
          </ul>`;
          break;
        case 'ftd':
          title = 'FTD Options';
          content = `<ul>
            <li>üìÖ FTD Schedule</li>
            <li>üìù FTD Report</li>
          </ul>`;
          break;
      }

      document.getElementById('aircraftModalLabel').textContent = title;
      modalBody.innerHTML = content;
      new bootstrap.Modal(document.getElementById('aircraftModal')).show();
    });
  });


    const today = new Date();
const options = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };
const formattedDate = today.toLocaleDateString('id-ID', options); // contoh: "Rabu, 18 Juni 2025"
document.getElementById("today").textContent = formattedDate;

const todayStr = `${today.getFullYear()}-${(today.getMonth()+1).toString().padStart(2,'0')}-${today.getDate().toString().padStart(2,'0')}`;

    fetch(`https://to.baliflightacademy.com:7329/srs/api_kiosk/flight_schedule?date=${todayStr}`)
      .then(res => res.json())
      .then(json => {
        const flights = json.data || [];
        const container = document.getElementById("flightsContainer");

        if (!flights.length) {
          container.innerHTML = `<div class="text-center text-muted p-4">üì≠ No flight schedule available for today.</div>`;
          return;
        }

        // Update summary (optional values from API if available)
        document.getElementById("total_flight").textContent = flights.length;

        const aircraftSet = new Set();
        let totalDurationMinutes = 0;

        // Group every 8 flights into one slide
        const groupSize = 8;
        for (let i = 0; i < flights.length; i += groupSize) {
          const group = flights.slice(i, i + groupSize);
          const slide = document.createElement("div");
          slide.className = "swiper-slide";

          const grid = document.createElement("div");
          grid.className = "row row-cols-1 row-cols-sm-2 row-cols-lg-4 g-3";

          group.forEach(f => {
            if (f.aircraft_reg) aircraftSet.add(f.aircraft_reg);
            if (f.eet) {
              const [h, m] = f.eet.split(":").map(Number);
              totalDurationMinutes += h * 60 + m;
            }

            const col = document.createElement("div");
            col.className = "col";
            col.innerHTML = `
              <div class="card-flight">
                <div class="card-header-flight">
                  <h5 class="m-0 text-primary fw-semibold">‚úàÔ∏è <a href="#" class="text-decoration-none text-primary fw-semibold aircraft-link" data-reg="${f.aircraft_reg}">
  ${f.aircraft_reg || '-'}
</a>
                    <span class="badge bg-light text-dark">${f.origin_base || '-'}</span>
                  </h5>
                  <span class="badge-time">ETD ${f.etd_utc || '-'} - ETA ${f.eta_utc || '-'}</span>
                </div>
                <div class="flight-detail-row">
                  <div><strong>Date:</strong> ${f.date_of_flight || '-'}</div>
                  <div><strong>PIC:</strong> <span class="badge bg-success">${f.pic_name || '-'}</span></div>
                  <div><strong>2nd:</strong> ${f.second_name || '-'}</div>
                  <div><strong>Batch:</strong> ${f.batch || '-'}</div>
                  <div><strong>TPM:</strong> ${f.tpm || '-'}</div>
                  <div><strong>Course:</strong> ${f.course_code_name || '-'}</div>
                  <div><strong>Mission:</strong> ${f.mission_code_name || '-'} - ${f.mission_name || '-'}</div>
                  <div><strong>Route:</strong> ${f.rute || '-'}</div>
                  <div><strong>DEP - ARR:</strong> ${f.dep || '-'} ‚Üí ${f.arr || '-'}</div>
                  <div><strong>EET:</strong> ${f.eet || '-'}</div>
                  <div><strong>Remark:</strong> ${f.remark || '-'}</div>
                </div>
              </div>
            `;
            grid.appendChild(col);
          });

          slide.appendChild(grid);
          container.appendChild(slide);
        }

        document.getElementById("total_aircraft").textContent = aircraftSet.size;
        const hours = Math.floor(totalDurationMinutes / 60).toString().padStart(2, "0");
        const minutes = (totalDurationMinutes % 60).toString().padStart(2, "0");
        document.getElementById("total_plan").textContent = `${hours}:${minutes}`;

        // Init Swiper
        new Swiper(".mySwiper", {
          loop: true,
          autoplay: {
            delay: 8000,
            disableOnInteraction: false,
          },
          pagination: {
            el: ".swiper-pagination",
            clickable: true,
          }
        });
      })
      .catch(err => {
        console.error(err);
        document.getElementById("flightsContainer").innerHTML = `<div class="text-danger text-center">‚ö†Ô∏è Failed to load flight data</div>`;
      });

     document.addEventListener('click', function(e) {
  if (e.target.classList.contains('aircraft-link')) {
    const reg = e.target.getAttribute('data-reg');
    const modalBody = document.getElementById('aircraftDetailContent');
    modalBody.innerHTML = `<p class="text-center text-muted">Loading...</p>`;
    
    fetch(`/srs/api_kiosk/aircraft_detail/${reg}`)
      .then(res => res.json())
      .then(data => {
        const ac = data || {};
        modalBody.innerHTML = `
          <div class="row">
            <div class="col-md-5 text-center mb-3">
              <img src="${ac.image_url || 'https://via.placeholder.com/400x300?text=No+Image'}" class="img-fluid rounded shadow" alt="${ac.aircraft_code}" />
            </div>
            <div class="col-md-7">
              <h5>${ac.aircraft_code || '-'} - ${ac.aircraft_name || '-'}</h5>
              <p><strong>Type:</strong> ${ac.type_code || '-'}</p>
              <p><strong>Mode S:</strong> ${ac.mode_s || '-'}</p>
              <p><strong>SN:</strong> ${ac.sn || '-'}</p>
              <p><strong>Year:</strong> ${ac.age || '-'}</p>
              <p><strong>Operator:</strong> ${ac.operator || '-'}</p>
            </div>
          </div>
        `;
        new bootstrap.Modal(document.getElementById('aircraftModal')).show();
      })
      .catch(err => {
        console.error(err);
        modalBody.innerHTML = `<p class="text-danger text-center">Failed to load aircraft data.</p>`;
        new bootstrap.Modal(document.getElementById('aircraftModal')).show();
      });
  }
});
  </script>

<!-- Modal Detail Aircraft -->
<div class="modal fade" id="aircraftModal" tabindex="-1" aria-labelledby="aircraftModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="aircraftModalLabel">Aircraft Detail</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="aircraftDetailContent">
        <p class="text-center text-muted">Loading...</p>
      </div>
    </div>
  </div>
</div>
</body>
</html>

        </div>
      </div>
	    

    </div>

    <div class="swiper-pagination mb-6"></div>
  </div>

  <!-- SwiperJS -->
  <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
<script>
  const swiper = new Swiper('.swiper', {
    direction: 'horizontal',
    loop: true,
    autoplay: {
      delay: 5000,
      disableOnInteraction: false,
    },
    pagination: {
      el: '.swiper-pagination',
      clickable: true,
    },
  });

  // Atur logika ketika masuk ke Slide 4
  swiper.on('slideChange', () => {
    const currentIndex = swiper.realIndex;
    if (currentIndex === 3) { // Slide ke-4 (index dimulai dari 0)
      swiper.autoplay.stop(); // Hentikan autoplay
      console.log("Stay on slide 4 for 30 minutes...");
      
      setTimeout(() => {
        swiper.slideToLoop(0); // Kembali ke Slide 1
        swiper.autoplay.start(); // Mulai autoplay kembali
        console.log("Returning to slide 1...");
      }, 30 * 60 * 1000); // 30 menit dalam milidetik (1800000)
    }
  });
  
   function openModal(title, content) {
    document.getElementById('modalTitle').textContent = title;
    document.getElementById('modalContent').textContent = content;
    document.getElementById('customModal').classList.remove('hidden');
  }

  function closeModal() {
    document.getElementById('customModal').classList.add('hidden');
  }

  // Aktifkan feather icons
  feather.replace();
</script>

<!-- Modal -->
<div id="customModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white rounded-xl p-6 max-w-md text-center shadow-xl">
    <h2 id="modalTitle" class="text-xl font-bold mb-2 text-blue-600">Modal Title</h2>
    <p id="modalContent" class="mb-4 text-gray-700">Modal content goes here.</p>
    <button onclick="closeModal()" class="bg-blue-600 text-white px-4 py-2 rounded-full hover:bg-blue-700 transition">Close</button>
  </div>
</div>
</body>
</html>
